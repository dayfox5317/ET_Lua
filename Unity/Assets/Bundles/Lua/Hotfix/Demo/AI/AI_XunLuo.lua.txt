-- Generated by CSharp.lua Compiler
local System = System
local ET = ET
local ET
System.import(function (out)
  ET = out.ET
end)
System.namespace("ET", function (namespace)
  namespace.class("AI_XunLuo", function (namespace)
    local Check, Execute
    Check = function (this, aiComponent, aiConfig)
      local sec = System.mod(System.div(ET.TimeHelper.ClientNow(), 1000), 15)
      if sec < 10 then
        return 0
      end
      return 1
    end
    Execute = function (this, aiComponent, aiConfig, cancellationToken)
      return System.async(function (async, this, aiComponent, aiConfig, cancellationToken)
        local zoneScene = ET.SceneHelper.DomainScene(aiComponent)

        local myUnit = zoneScene:GetComponent(ET.UnitComponent).MyUnit
        if myUnit == nil then
          return
        end

        ET.Log.Debug("开始巡逻")

        while true do
          local xunLuoPathComponent = myUnit:GetComponent(ET.XunLuoPathComponent)
          local nextTarget = ET.XunLuoPathComponentSystem.GetCurrent(xunLuoPathComponent)
          local ret = async:Await(ET.MoveHelper.MoveToAsync(myUnit, nextTarget:__clone__(), cancellationToken))
          if ret ~= 0 then
            return
          end
          ET.XunLuoPathComponentSystem.MoveNext(xunLuoPathComponent)
        end
      end, nil, this, aiComponent, aiConfig, cancellationToken)
    end
    return {
      base = function (out)
        return {
          out.ET.AAIHandler
        }
      end,
      Check = Check,
      Execute = Execute,
      __metadata__ = function (out)
        return {
          methods = {
            { "Check", 0x286, Check, out.ET.AIComponent, out.ET.AIConfig, System.Int32 },
            { "Execute", 0x386, Execute, out.ET.AIComponent, out.ET.AIConfig, out.ET.ETCancellationToken, out.ET.ETVoid }
          },
          class = { 0x6 }
        }
      end
    }
  end)
end)
