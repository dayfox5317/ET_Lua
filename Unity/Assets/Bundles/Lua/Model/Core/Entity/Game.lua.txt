-- Generated by CSharp.lua Compiler
local System = System
local ETCold = ETCold
local ListDelegate = System.List(System.Delegate)
local ET
System.import(function (out)
  ET = out.ET
end)
System.namespace("ET", function (namespace)
  namespace.class("Game", function (namespace)
    local getThreadSynchronizationContext, getTimeInfo, getEventSystem, scene, getScene, getObjectPool, getIdGenerater, Update, 
    LateUpdate, FrameFinish, Close, class, static
    static = function (this)
      this.FrameFinishCallback = ListDelegate()
    end
    getThreadSynchronizationContext = function ()
      return ETCold.ThreadSynchronizationContext.getInstance()
    end
    getTimeInfo = function ()
      return ET.TimeInfo.Instance
    end
    getEventSystem = function ()
      return ET.EventSystem.getInstance()
    end
    getScene = function ()
      if scene ~= nil then
        return scene
      end
      local instanceIdStruct = System.new(ET.InstanceIdStruct, 3, class.Options.Process, 0)
      scene = ET.EntitySceneFactory.CreateScene1(instanceIdStruct:ToLong(), 0, ET.SceneType.Process, "Process")
      return scene
    end
    getObjectPool = function ()
      return ET.ObjectPool.getInstance()
    end
    getIdGenerater = function ()
      return ET.IdGenerater.Instance
    end
    Update = function ()
      -- ThreadSynchronizationContext.Update();
      getTimeInfo():Update()
      getEventSystem():Update()
    end
    LateUpdate = function ()
      getEventSystem():LateUpdate()
    end
    FrameFinish = function ()
      for _, action in System.each(class.FrameFinishCallback) do
        action()
      end
      class.FrameFinishCallback:Clear()
    end
    Close = function ()
      local default = scene
      if default ~= nil then
        default:Dispose()
      end
      scene = nil
      ET.ObjectPool.getInstance():Dispose()
      ET.EventSystem.getInstance():Dispose()
      ET.IdGenerater.Instance:Dispose()
    end
    class = {
      getThreadSynchronizationContext = getThreadSynchronizationContext,
      getTimeInfo = getTimeInfo,
      getEventSystem = getEventSystem,
      getScene = getScene,
      getObjectPool = getObjectPool,
      getIdGenerater = getIdGenerater,
      Update = Update,
      LateUpdate = LateUpdate,
      FrameFinish = FrameFinish,
      Close = Close,
      static = static,
      __metadata__ = function (out)
        return {
          properties = {
            { "EventSystem", 0x20E, out.ET.EventSystem, getEventSystem },
            { "IdGenerater", 0x20E, out.ET.IdGenerater, getIdGenerater },
            { "ObjectPool", 0x20E, out.ET.ObjectPool, getObjectPool },
            { "Scene", 0x20E, out.ET.Scene, getScene },
            { "ThreadSynchronizationContext", 0x20E, out.ETCold.ThreadSynchronizationContext, getThreadSynchronizationContext },
            { "TimeInfo", 0x20E, out.ET.TimeInfo, getTimeInfo }
          },
          fields = {
            { "FrameFinishCallback", 0xE, System.List(System.Delegate) },
            { "Options", 0xE, out.ET.Options },
            { "scene", 0x9, out.ET.Scene }
          },
          methods = {
            { "Close", 0xE, Close },
            { "FrameFinish", 0xE, FrameFinish },
            { "LateUpdate", 0xE, LateUpdate },
            { "Update", 0xE, Update }
          },
          class = { 0xE }
        }
      end
    }
    return class
  end)
end)
