-- Generated by CSharp.lua Compiler
local System = System
local Linq = System.Linq.Enumerable
System.namespace("ET", function (namespace)
  namespace.class("MultiMapSet_2", function (namespace)
    return function (T, K)
      local Add, Remove, GetAll, get1, GetOne, Contains, __ctor__
      local ArrayK = System.Array(K)
      local HashSetK = System.HashSet(K)
      local SortedDictionary_2THashSetK = System.SortedDictionary_2(T, HashSetK)
      __ctor__ = function (this)
        this.Empty = HashSetK()
        SortedDictionary_2THashSetK.__ctor__(this)
      end
      Add = function (this, t, k)
        local list
        local _
        _, list = this:TryGetValue(t)
        if list == nil then
          list = HashSetK()
          this:AddKeyValue(t, list)
        end
        list:Add(k)
      end
      Remove = function (this, t, k)
        local list
        local _
        _, list = this:TryGetValue(t)
        if list == nil then
          return false
        end
        if not list:Remove(k) then
          return false
        end
        if list:getCount() == 0 then
          this:RemoveKey(t)
        end
        return true
      end
      -- <summary>
      -- 不返回内部的list,copy一份出来
      -- </summary>
      -- <param name="t"></param>
      -- <returns></returns>
      GetAll = function (this, t)
        local list
        local _
        _, list = this:TryGetValue(t)
        if list == nil then
          return ArrayK:new(0)
        end
        return Linq.ToArray(list)
      end
      get1 = function (this, t)
        local _, list = this:TryGetValue(t)
        return list or this.Empty
      end
      GetOne = function (this, t)
        local list
        local _
        _, list = this:TryGetValue(t)
        if list ~= nil and list:getCount() > 0 then
          return Linq.FirstOrDefault(list)
        end
        return System.default(K)
      end
      Contains = function (this, t, k)
        local list
        local _
        _, list = this:TryGetValue(t)
        if list == nil then
          return false
        end
        return list:Contains(k)
      end
      return {
        base = function (out)
          return {
            System.SortedDictionary_2(T, System.HashSet(K))
          }
        end,
        Add = Add,
        Remove = Remove,
        GetAll = GetAll,
        get1 = get1,
        GetOne = GetOne,
        Contains = Contains,
        __ctor__ = __ctor__,
        __metadata__ = function (out)
          return {
            fields = {
              { "Empty", 0x1, System.HashSet(K) }
            },
            methods = {
              { "Add", 0x206, Add, T, K },
              { "Contains", 0x286, Contains, T, K, System.Boolean },
              { "GetAll", 0x186, GetAll, T, System.Array(K) },
              { "GetOne", 0x186, GetOne, T, K },
              { "Remove", 0x286, Remove, T, K, System.Boolean }
            },
            class = { 0x206, T, K }
          }
        end
      }
    end
  end)
end)
