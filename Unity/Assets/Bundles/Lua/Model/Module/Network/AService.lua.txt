-- Generated by CSharp.lua Compiler
local System = System
local ET
System.import(function (out)
  ET = out.ET
end)
System.namespace("ET", function (namespace)
  namespace.class("AService", function (namespace)
    local CreateConnectChannelId, CreateRandomLocalConn, CreateAcceptChannelId, OnAccept, OnRead, OnError, Destroy, RemoveChannel, 
    SendStream, GetOrCreate, __ctor__
    __ctor__ = function (this)
      this.ServiceType = ET.ServiceType.Outer
    end
    CreateConnectChannelId = function (this, localConn)
      local default = this.connectIdGenerater - 1
      this.connectIdGenerater = default
      return System.bor((System.sl(default, 32)), localConn)
    end
    CreateRandomLocalConn = function (this)
      return System.bor((1073741824 --[[1u << 30]]), ET.RandomHelper.RandUInt32())
    end
    CreateAcceptChannelId = function (this, localConn)
      local default = this.acceptIdGenerater + 1
      this.acceptIdGenerater = default
      return System.bor((System.sl(default, 32)), localConn)
    end
    OnAccept = function (this, channelId, ipEndPoint)
      this.AcceptCallback(channelId, ipEndPoint)
    end
    OnRead = function (this, channelId, memoryStream)
      this.ReadCallback(channelId, memoryStream)
    end
    OnError = function (this, channelId, e)
      this:Remove(channelId)

      local default = this.ErrorCallback
      if default ~= nil then
        default(channelId, e)
      end
    end
    Destroy = function (this)
      this:Dispose()
    end
    RemoveChannel = function (this, channelId)
      this:Remove(channelId)
    end
    SendStream = function (this, channelId, actorId, stream)
      this:Send(channelId, actorId, stream)
    end
    GetOrCreate = function (this, id, address)
      this:Get(id, address)
    end
    return {
      base = function (out)
        return {
          System.IDisposable
        }
      end,
      connectIdGenerater = 2147483647 --[[Int32.MaxValue]],
      CreateConnectChannelId = CreateConnectChannelId,
      CreateRandomLocalConn = CreateRandomLocalConn,
      acceptIdGenerater = 1,
      CreateAcceptChannelId = CreateAcceptChannelId,
      OnAccept = OnAccept,
      OnRead = OnRead,
      OnError = OnError,
      Destroy = Destroy,
      RemoveChannel = RemoveChannel,
      SendStream = SendStream,
      GetOrCreate = GetOrCreate,
      __ctor__ = __ctor__,
      __metadata__ = function (out)
        return {
          properties = {
            { "ServiceType", 0x6, out.ET.ServiceType }
          },
          fields = {
            { "AcceptCallback", 0x6, System.Delegate(System.Int64, System.Net.IPEndPoint, System.Void) },
            { "acceptIdGenerater", 0x1, System.Int64 },
            { "connectIdGenerater", 0x1, System.Int64 },
            { "ErrorCallback", 0x6, System.Delegate(System.Int64, System.Int32, System.Void) },
            { "ReadCallback", 0x6, System.Delegate(System.Int64, System.IO.MemoryStream, System.Void) },
            { "ThreadSynchronizationContext", 0x6, out.ETCold.ThreadSynchronizationContext }
          },
          methods = {
            { "CreateAcceptChannelId", 0x186, CreateAcceptChannelId, System.UInt32, System.Int64 },
            { "CreateConnectChannelId", 0x186, CreateConnectChannelId, System.UInt32, System.Int64 },
            { "CreateRandomLocalConn", 0x86, CreateRandomLocalConn, System.UInt32 },
            { "Destroy", 0x6, Destroy },
            { "GetOrCreate", 0x206, GetOrCreate, System.Int64, System.Net.IPEndPoint },
            { "OnAccept", 0x203, OnAccept, System.Int64, System.Net.IPEndPoint },
            { "OnError", 0x206, OnError, System.Int64, System.Int32 },
            { "OnRead", 0x206, OnRead, System.Int64, System.IO.MemoryStream },
            { "RemoveChannel", 0x106, RemoveChannel, System.Int64 },
            { "SendStream", 0x306, SendStream, System.Int64, System.Int64, System.IO.MemoryStream }
          },
          class = { 0x6 }
        }
      end
    }
  end)
end)
